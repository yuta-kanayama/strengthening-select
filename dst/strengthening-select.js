var OrderedSelectModel=Backbone.Model.extend({defaults:function(){return{val:"",selected:!1,iniVal:""}},initialize:function(){_.bindAll(this,"changeValue"),this.on("change:val",this.changeValue)},changeValue:function(){var e=this.get("val"),t=this.get("iniVal"),s=e!=t?!0:!1;this.set("selected",s)}}),OrderedSelectCollection=Backbone.Collection.extend({model:OrderedSelectModel}),OrderedSelect=Backbone.View.extend({events:{"change .ordered-select__select":"changeSelect"},initialize:function(){_.bindAll(this,"changeSelect","switchSubmitStatus","enableSelect","disableSelect","isCanSubmit"),this.$enabled=this.$(".ordered-select__submit--enabled"),this.$disabled=this.$(".ordered-select__submit--disabled"),this.$select=this.$(".ordered-select__select"),this.select=new OrderedSelectCollection,this.$select.each(_.bind(function(e,t){var s=$(t),i=s.val();this.select.add({val:i,iniVal:i})},this)),this.disableSelect(this.$select.not(":first")),this.switchSubmitStatus()},changeSelect:function(e){var t=$(e.target),s=t.val(),i=this.$select.index(e.target);this.select.at(i).set("val",s),this.switchSubmitStatus()},switchSubmitStatus:function(){this.isCanSubmit()?(this.$enabled.css("display","block"),this.$disabled.css("display","none")):(this.$enabled.css("display","none"),this.$disabled.css("display","block"))},enableSelect:function(e){e.removeClass("ordered-select__select--disabled").addClass("ordered-select__select--enabled").find("option").removeAttr("disabled"),e.parents(".ordered-select__select-wrapper").removeClass("ordered-select__select-wrapper--disabled").addClass("ordered-select__select-wrapper--enabled")},disableSelect:function(e){e.removeClass("ordered-select__select--enabled").addClass("ordered-select__select--disabled").find("option").attr("disabled","disabled"),e.parents(".ordered-select__select-wrapper").removeClass("ordered-select__select-wrapper--enabled").addClass("ordered-select__select-wrapper--disabled")},isCanSubmit:function(){var e=!0;return this.select.each(_.bind(function(t,s){var i=t.get("selected");i||(e=!1),s&&(this.select.at(s-1).get("selected")?this.enableSelect(this.$select.eq(s)):this.disableSelect(this.$select.eq(s)))},this)),e}}),SelectiveSelectModel=Backbone.Model.extend({defaults:function(){return{val:"",selected:!1,iniVal:""}},initialize:function(){_.bindAll(this,"changeValue"),this.on("change:val",this.changeValue)},changeValue:function(){var e=this.get("val"),t=this.get("iniVal"),s=e!=t?!0:!1;this.set("selected",s)}}),SelectiveSelectCollection=Backbone.Collection.extend({model:SelectiveSelectModel}),SelectiveSelect=Backbone.View.extend({events:{"change .selective-select__select":"changeSelect"},initialize:function(e){_.bindAll(this,"changeSelect","switchSubmitStatus","isCanSubmit");var t={target:"all"};this.opt=_.extend(t,e),this.$enabled=this.$(".selective-select__submit--enabled"),this.$disabled=this.$(".selective-select__submit--disabled"),this.$select=this.$(".selective-select__select"),this.select=new SelectiveSelectCollection,this.$select.each(_.bind(function(e,t){var s=$(t),i=s.val();this.select.add({val:i,iniVal:i})},this)),this.switchSubmitStatus()},changeSelect:function(e){var t=$(e.target),s=t.val(),i=this.$select.index(e.target);this.select.at(i).set("val",s),this.switchSubmitStatus()},switchSubmitStatus:function(){this.isCanSubmit()?(this.$enabled.css("display","block"),this.$disabled.css("display","none")):(this.$enabled.css("display","none"),this.$disabled.css("display","block"))},isCanSubmit:function(){if("any"==this.opt.target){var e=!1;this.select.each(_.bind(function(t,s){var i=t.get("selected");i&&(e=!0)},this))}else{var e=!0;this.select.each(_.bind(function(t,s){var i=t.get("selected");i||(e=!1)},this))}return e}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9yZGVyZWQtc2VsZWN0LmpzIiwic2VsZWN0aXZlLXNlbGVjdC5qcyJdLCJuYW1lcyI6WyJPcmRlcmVkU2VsZWN0TW9kZWwiLCJCYWNrYm9uZSIsIk1vZGVsIiwiZXh0ZW5kIiwiZGVmYXVsdHMiLCJ2YWwiLCJzZWxlY3RlZCIsImluaVZhbCIsImluaXRpYWxpemUiLCJfIiwiYmluZEFsbCIsInRoaXMiLCJvbiIsImNoYW5nZVZhbHVlIiwiZ2V0Iiwic2V0IiwiT3JkZXJlZFNlbGVjdENvbGxlY3Rpb24iLCJDb2xsZWN0aW9uIiwibW9kZWwiLCJPcmRlcmVkU2VsZWN0IiwiVmlldyIsImV2ZW50cyIsImNoYW5nZSAub3JkZXJlZC1zZWxlY3RfX3NlbGVjdCIsIiRlbmFibGVkIiwiJCIsIiRkaXNhYmxlZCIsIiRzZWxlY3QiLCJzZWxlY3QiLCJlYWNoIiwiYmluZCIsImkiLCJlIiwiJG1lIiwiYWRkIiwiZGlzYWJsZVNlbGVjdCIsIm5vdCIsInN3aXRjaFN1Ym1pdFN0YXR1cyIsImNoYW5nZVNlbGVjdCIsInRhcmdldCIsImluZGV4IiwiYXQiLCJpc0NhblN1Ym1pdCIsImNzcyIsImVuYWJsZVNlbGVjdCIsIiR0YXJnZXQiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiZmluZCIsInJlbW92ZUF0dHIiLCJwYXJlbnRzIiwiYXR0ciIsInJlc3VsdCIsImVxIiwiU2VsZWN0aXZlU2VsZWN0TW9kZWwiLCJTZWxlY3RpdmVTZWxlY3RDb2xsZWN0aW9uIiwiU2VsZWN0aXZlU2VsZWN0IiwiY2hhbmdlIC5zZWxlY3RpdmUtc2VsZWN0X19zZWxlY3QiLCJvcHQiLCJtZSJdLCJtYXBwaW5ncyI6IkFBVUEsR0FBQUEsb0JBQUFDLFNBQUFDLE1BQUFDLFFBQ0FDLFNBQUEsV0FDQSxPQUNBQyxJQUFBLEdBQ0FDLFVBQUEsRUFDQUMsT0FBQSxLQUlBQyxXQUFBLFdBQ0FDLEVBQUFDLFFBQUFDLEtBQUEsZUFDQUEsS0FBQUMsR0FBQSxhQUFBRCxLQUFBRSxjQUdBQSxZQUFB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QUEsSUFDQXhDLE9BRUEsTUFBQXdDIiwiZmlsZSI6InN0cmVuZ3RoZW5pbmctc2VsZWN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiMgT3JkZXJlZFNlbGVjdFxuKi9cblxuXG5cbi8qXG4jIyBTZWxlY3QgTW9kZWxcbiovXG5cbnZhciBPcmRlcmVkU2VsZWN0TW9kZWwgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xuICBkZWZhdWx0czogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbDogJycsXG4gICAgICBzZWxlY3RlZDogZmFsc2UsXG4gICAgICBpbmlWYWw6ICcnXG4gICAgfVxuICB9LFxuICBcbiAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgXy5iaW5kQWxsKHRoaXMsICdjaGFuZ2VWYWx1ZScpO1xuICAgIHRoaXMub24oJ2NoYW5nZTp2YWwnLCB0aGlzLmNoYW5nZVZhbHVlKTtcbiAgfSxcbiAgXG4gIGNoYW5nZVZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdmFsID0gdGhpcy5nZXQoJ3ZhbCcpLFxuICAgICAgICBpbmlWYWwgPSB0aGlzLmdldCgnaW5pVmFsJyksXG4gICAgICAgIHNlbGVjdGVkID0gKHZhbCAhPSBpbmlWYWwpP3RydWU6ZmFsc2U7XG4gICAgdGhpcy5zZXQoJ3NlbGVjdGVkJywgc2VsZWN0ZWQpO1xuICB9XG59KTtcblxuXG5cbi8qXG4jIyBcbiovXG5cbnZhciBPcmRlcmVkU2VsZWN0Q29sbGVjdGlvbiA9IEJhY2tib25lLkNvbGxlY3Rpb24uZXh0ZW5kKHtcbiAgbW9kZWw6IE9yZGVyZWRTZWxlY3RNb2RlbFxufSk7XG5cblxuXG4vKlxuIyMgXG4qL1xuXG52YXIgT3JkZXJlZFNlbGVjdCA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgXG4gIGV2ZW50czoge1xuICAgICdjaGFuZ2UgLm9yZGVyZWQtc2VsZWN0X19zZWxlY3QnOiAnY2hhbmdlU2VsZWN0J1xuICB9LFxuICBcbiAgXG4gIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgIF8uYmluZEFsbCh0aGlzLCAnY2hhbmdlU2VsZWN0JywgJ3N3aXRjaFN1Ym1pdFN0YXR1cycsICdlbmFibGVTZWxlY3QnLCAnZGlzYWJsZVNlbGVjdCcsICdpc0NhblN1Ym1pdCcpO1xuICAgIFxuICAgIHRoaXMuJGVuYWJsZWQgPSB0aGlzLiQoJy5vcmRlcmVkLXNlbGVjdF9fc3VibWl0LS1lbmFibGVkJyk7XG4gICAgdGhpcy4kZGlzYWJsZWQgPSB0aGlzLiQoJy5vcmRlcmVkLXNlbGVjdF9fc3VibWl0LS1kaXNhYmxlZCcpO1xuICAgIHRoaXMuJHNlbGVjdCA9IHRoaXMuJCgnLm9yZGVyZWQtc2VsZWN0X19zZWxlY3QnKTtcbiAgICBcbiAgICB0aGlzLnNlbGVjdCA9IG5ldyBPcmRlcmVkU2VsZWN0Q29sbGVjdGlvbigpO1xuICAgIHRoaXMuJHNlbGVjdC5lYWNoKF8uYmluZChmdW5jdGlvbihpLCBlKSB7XG4gICAgICB2YXIgJG1lID0gJChlKSxcbiAgICAgICAgICB2YWwgPSAkbWUudmFsKCk7XG4gICAgICB0aGlzLnNlbGVjdC5hZGQoe1xuICAgICAgICB2YWw6IHZhbCxcbiAgICAgICAgaW5pVmFsOiB2YWxcbiAgICAgIH0pO1xuICAgIH0sIHRoaXMpKTtcbiAgICBcbiAgICB0aGlzLmRpc2FibGVTZWxlY3QoIHRoaXMuJHNlbGVjdC5ub3QoJzpmaXJzdCcpICk7XG4gICAgXG4gICAgdGhpcy5zd2l0Y2hTdWJtaXRTdGF0dXMoKTtcbiAgfSxcbiAgXG4gIFxuICBjaGFuZ2VTZWxlY3Q6IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgJG1lID0gJChlLnRhcmdldCksXG4gICAgICAgIHZhbCA9ICRtZS52YWwoKSxcbiAgICAgICAgaW5kZXggPSB0aGlzLiRzZWxlY3QuaW5kZXgoZS50YXJnZXQpO1xuICAgIFxuICAgIHRoaXMuc2VsZWN0LmF0KGluZGV4KS5zZXQoJ3ZhbCcsIHZhbCk7XG4gICAgXG4gICAgdGhpcy5zd2l0Y2hTdWJtaXRTdGF0dXMoKTtcbiAgfSxcbiAgXG4gIFxuICBzd2l0Y2hTdWJtaXRTdGF0dXM6IGZ1bmN0aW9uKCl7XG4gICAgaWYodGhpcy5pc0NhblN1Ym1pdCgpKXtcbiAgICAgIHRoaXMuJGVuYWJsZWQuY3NzKCdkaXNwbGF5JywnYmxvY2snKTtcbiAgICAgIHRoaXMuJGRpc2FibGVkLmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4kZW5hYmxlZC5jc3MoJ2Rpc3BsYXknLCdub25lJyk7XG4gICAgICB0aGlzLiRkaXNhYmxlZC5jc3MoJ2Rpc3BsYXknLCdibG9jaycpO1xuICAgIH1cbiAgfSxcbiAgXG4gIFxuICBlbmFibGVTZWxlY3Q6IGZ1bmN0aW9uKCR0YXJnZXQpIHtcbiAgICAkdGFyZ2V0XG4gICAgICAucmVtb3ZlQ2xhc3MoJ29yZGVyZWQtc2VsZWN0X19zZWxlY3QtLWRpc2FibGVkJylcbiAgICAgIC5hZGRDbGFzcygnb3JkZXJlZC1zZWxlY3RfX3NlbGVjdC0tZW5hYmxlZCcpXG4gICAgICAuZmluZCgnb3B0aW9uJylcbiAgICAgIC5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuICAgICR0YXJnZXRcbiAgICAgIC5wYXJlbnRzKCcub3JkZXJlZC1zZWxlY3RfX3NlbGVjdC13cmFwcGVyJylcbiAgICAgIC5yZW1vdmVDbGFzcygnb3JkZXJlZC1zZWxlY3RfX3NlbGVjdC13cmFwcGVyLS1kaXNhYmxlZCcpXG4gICAgICAuYWRkQ2xhc3MoJ29yZGVyZWQtc2VsZWN0X19zZWxlY3Qtd3JhcHBlci0tZW5hYmxlZCcpO1xuICB9LFxuICBcbiAgXG4gIGRpc2FibGVTZWxlY3Q6IGZ1bmN0aW9uKCR0YXJnZXQpIHtcbiAgICAkdGFyZ2V0XG4gICAgICAucmVtb3ZlQ2xhc3MoJ29yZGVyZWQtc2VsZWN0X19zZWxlY3QtLWVuYWJsZWQnKVxuICAgICAgLmFkZENsYXNzKCdvcmRlcmVkLXNlbGVjdF9fc2VsZWN0LS1kaXNhYmxlZCcpXG4gICAgICAuZmluZCgnb3B0aW9uJylcbiAgICAgIC5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICR0YXJnZXRcbiAgICAgIC5wYXJlbnRzKCcub3JkZXJlZC1zZWxlY3RfX3NlbGVjdC13cmFwcGVyJylcbiAgICAgIC5yZW1vdmVDbGFzcygnb3JkZXJlZC1zZWxlY3RfX3NlbGVjdC13cmFwcGVyLS1lbmFibGVkJylcbiAgICAgIC5hZGRDbGFzcygnb3JkZXJlZC1zZWxlY3RfX3NlbGVjdC13cmFwcGVyLS1kaXNhYmxlZCcpO1xuICB9LFxuICBcbiAgXG4gIGlzQ2FuU3VibWl0OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgICB0aGlzLnNlbGVjdC5lYWNoKF8uYmluZChmdW5jdGlvbihtb2RlbCwgaW5kZXgpe1xuICAgICAgdmFyIHNlbGVjdGVkID0gbW9kZWwuZ2V0KCdzZWxlY3RlZCcpO1xuICAgICAgaWYoIXNlbGVjdGVkKSByZXN1bHQgPSBmYWxzZTtcbiAgICAgIGlmKGluZGV4KSB7XG4gICAgICAgIGlmKHRoaXMuc2VsZWN0LmF0KGluZGV4LTEpLmdldCgnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgIHRoaXMuZW5hYmxlU2VsZWN0KHRoaXMuJHNlbGVjdC5lcShpbmRleCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZGlzYWJsZVNlbGVjdCh0aGlzLiRzZWxlY3QuZXEoaW5kZXgpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHRoaXMpKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG4gIFxufSk7XG4iLCIvKlxuIyBTZWxlY3RpdmVTZWxlY3RcbiovXG5cblxuXG4vKlxuIyMgU2VsZWN0IE1vZGVsXG4qL1xuXG52YXIgU2VsZWN0aXZlU2VsZWN0TW9kZWwgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xuICBkZWZhdWx0czogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbDogJycsXG4gICAgICBzZWxlY3RlZDogZmFsc2UsXG4gICAgICBpbmlWYWw6ICcnXG4gICAgfVxuICB9LFxuICBcbiAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgXy5iaW5kQWxsKHRoaXMsICdjaGFuZ2VWYWx1ZScpO1xuICAgIHRoaXMub24oJ2NoYW5nZTp2YWwnLCB0aGlzLmNoYW5nZVZhbHVlKTtcbiAgfSxcbiAgXG4gIGNoYW5nZVZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdmFsID0gdGhpcy5nZXQoJ3ZhbCcpLFxuICAgICAgICBpbmlWYWwgPSB0aGlzLmdldCgnaW5pVmFsJyksXG4gICAgICAgIHNlbGVjdGVkID0gKHZhbCAhPSBpbmlWYWwpP3RydWU6ZmFsc2U7XG4gICAgdGhpcy5zZXQoJ3NlbGVjdGVkJywgc2VsZWN0ZWQpO1xuICB9XG59KTtcblxuXG5cbi8qXG4jIyBcbiovXG5cbnZhciBTZWxlY3RpdmVTZWxlY3RDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoe1xuICBtb2RlbDogU2VsZWN0aXZlU2VsZWN0TW9kZWxcbn0pO1xuXG5cblxuLypcbiMjIFxuKi9cblxudmFyIFNlbGVjdGl2ZVNlbGVjdCA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgXG4gIGV2ZW50czoge1xuICAgICdjaGFuZ2UgLnNlbGVjdGl2ZS1zZWxlY3RfX3NlbGVjdCc6ICdjaGFuZ2VTZWxlY3QnXG4gIH0sXG4gIFxuICBcbiAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0KSB7XG4gICAgXy5iaW5kQWxsKHRoaXMsICdjaGFuZ2VTZWxlY3QnLCAnc3dpdGNoU3VibWl0U3RhdHVzJywgJ2lzQ2FuU3VibWl0Jyk7XG4gICAgXG4gICAgdmFyIGRlZmF1bHRzID0ge1xuICAgICAgdGFyZ2V0OiAnYWxsJ1xuICAgIH07XG4gICAgdGhpcy5vcHQgPSBfLmV4dGVuZChkZWZhdWx0cywgb3B0KTtcbiAgICBcbiAgICB0aGlzLiRlbmFibGVkID0gdGhpcy4kKCcuc2VsZWN0aXZlLXNlbGVjdF9fc3VibWl0LS1lbmFibGVkJyk7XG4gICAgdGhpcy4kZGlzYWJsZWQgPSB0aGlzLiQoJy5zZWxlY3RpdmUtc2VsZWN0X19zdWJtaXQtLWRpc2FibGVkJyk7XG4gICAgdGhpcy4kc2VsZWN0ID0gdGhpcy4kKCcuc2VsZWN0aXZlLXNlbGVjdF9fc2VsZWN0Jyk7XG4gICAgXG4gICAgdGhpcy5zZWxlY3QgPSBuZXcgU2VsZWN0aXZlU2VsZWN0Q29sbGVjdGlvbigpO1xuICAgIHRoaXMuJHNlbGVjdC5lYWNoKF8uYmluZChmdW5jdGlvbihpLCBtZSkge1xuICAgICAgdmFyICRtZSA9ICQobWUpLFxuICAgICAgICAgIHZhbCA9ICRtZS52YWwoKTtcbiAgICAgIHRoaXMuc2VsZWN0LmFkZCh7XG4gICAgICAgIHZhbDogdmFsLFxuICAgICAgICBpbmlWYWw6IHZhbFxuICAgICAgfSk7XG4gICAgfSwgdGhpcykpO1xuICAgIFxuICAgIC8vdGhpcy5kaXNhYmxlU2VsZWN0KCB0aGlzLiRzZWxlY3Qubm90KCc6Zmlyc3QnKSApO1xuICAgIFxuICAgIHRoaXMuc3dpdGNoU3VibWl0U3RhdHVzKCk7XG4gIH0sXG4gIFxuICBcbiAgY2hhbmdlU2VsZWN0OiBmdW5jdGlvbihlKSB7XG4gICAgdmFyICRtZSA9ICQoZS50YXJnZXQpLFxuICAgICAgICB2YWwgPSAkbWUudmFsKCksXG4gICAgICAgIGluZGV4ID0gdGhpcy4kc2VsZWN0LmluZGV4KGUudGFyZ2V0KTtcbiAgICBcbiAgICB0aGlzLnNlbGVjdC5hdChpbmRleCkuc2V0KCd2YWwnLCB2YWwpO1xuICAgIFxuICAgIHRoaXMuc3dpdGNoU3VibWl0U3RhdHVzKCk7XG4gIH0sXG4gIFxuICBcbiAgc3dpdGNoU3VibWl0U3RhdHVzOiBmdW5jdGlvbigpe1xuICAgIGlmKHRoaXMuaXNDYW5TdWJtaXQoKSl7XG4gICAgICB0aGlzLiRlbmFibGVkLmNzcygnZGlzcGxheScsJ2Jsb2NrJyk7XG4gICAgICB0aGlzLiRkaXNhYmxlZC5jc3MoJ2Rpc3BsYXknLCdub25lJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuJGVuYWJsZWQuY3NzKCdkaXNwbGF5Jywnbm9uZScpO1xuICAgICAgdGhpcy4kZGlzYWJsZWQuY3NzKCdkaXNwbGF5JywnYmxvY2snKTtcbiAgICB9XG4gIH0sXG4gIFxuICBcbiAgaXNDYW5TdWJtaXQ6IGZ1bmN0aW9uKCkge1xuICAgIGlmKCdhbnknID09IHRoaXMub3B0LnRhcmdldCkge1xuICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgdGhpcy5zZWxlY3QuZWFjaChfLmJpbmQoZnVuY3Rpb24obW9kZWwsIGluZGV4KXtcbiAgICAgICAgdmFyIHNlbGVjdGVkID0gbW9kZWwuZ2V0KCdzZWxlY3RlZCcpO1xuICAgICAgICBpZihzZWxlY3RlZCkgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgIH0sIHRoaXMpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgICB0aGlzLnNlbGVjdC5lYWNoKF8uYmluZChmdW5jdGlvbihtb2RlbCwgaW5kZXgpe1xuICAgICAgICB2YXIgc2VsZWN0ZWQgPSBtb2RlbC5nZXQoJ3NlbGVjdGVkJyk7XG4gICAgICAgIGlmKCFzZWxlY3RlZCkgcmVzdWx0ID0gZmFsc2U7XG4gICAgICB9LCB0aGlzKSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgXG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==